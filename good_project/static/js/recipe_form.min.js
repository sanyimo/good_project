import{initQuillEditors}from"./modules/quill_init.min.js";import{isQuillContentEmpty,syncSelect2Multiple,initAccessibleSelect2Multiple,removeEmptyErrorListItems,showMessage}from"./modules/utils.min.js";import{initIngredientHandlers}from"./modules/ingredients.min.js";import{fetchFormSubmit}from"./modules/fetchFormSubmit.min.js";const formMessages=document.getElementById("formMessages").dataset;document.addEventListener("DOMContentLoaded",()=>{window.placeholders;const{quillDescription:e,quillInstructions:t,quillTips:s,descField:i,instrField:r,tipsField:o}=initQuillEditors(placeholders);initIngredientHandlers(),initAccessibleSelect2Multiple();const n=document.querySelector("#recipe-form");n&&n?.addEventListener("submit",l=>{l.preventDefault();const m=n.querySelector('[type="submit"]');if(m&&(m.disabled=!0),i&&e&&isQuillContentEmpty(e))return alert(formMessages.descEmpty),void(m&&(m.disabled=!1));if(r&&t&&isQuillContentEmpty(t))return alert(formMessages.instrEmpty),void(m&&(m.disabled=!1));i&&e&&(i.value=e.root.innerHTML),r&&t&&(r.value=t.root.innerHTML),o&&s&&(o.value=s.root.innerHTML),syncSelect2Multiple(n);const d=document.getElementById("form-errors-container");fetchFormSubmit({form:n,containerId:d,showSpinner:showSpinner,hideSpinner:hideSpinner,onSuccess:e=>{removeEmptyErrorListItems(),e.message?(showMessage(e.status,e.message),setTimeout(()=>{window.location.href=e.redirect_url},1500)):window.location.href=e.redirect_url},onError:e=>{m&&(m.disabled=!1),removeEmptyErrorListItems(),e.message&&showMessage(e.status,e.message)}})})});